<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ | SWG. SHOP</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        .cart-page-section {
            padding: 60px 0;
            min-height: 70vh;
        }
        .cart-page-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }
        .cart-items-list {
            background: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .cart-items-list h2 {
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        .cart-item-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid #eee;
        }
        .cart-item-row:last-child {
            border-bottom: none;
        }
        .item-details {
            flex: 1;
        }
        .item-details h3 {
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        .item-price {
            color: #ff4b2b;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .qty-btn {
            width: 30px;
            height: 30px;
            border: 1px solid #ddd;
            background: #fff;
            cursor: pointer;
            border-radius: 3px;
            font-size: 1rem;
        }
        .qty-btn:hover {
            background: #f0f0f0;
        }
        .item-remove {
            background: #ff4b2b;
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 15px;
        }
        .item-remove:hover {
            background: #ff3d1f;
        }
        .empty-cart-message {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }
        .empty-cart-message p {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        .empty-cart-message a {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 30px;
            background: #ff4b2b;
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
        }
        .cart-summary {
            background: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        .cart-summary h3 {
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .summary-row:last-of-type {
            border-bottom: 2px solid #000;
            margin-bottom: 20px;
            font-weight: bold;
            font-size: 1.2rem;
        }
        .checkout-btn {
            width: 100%;
            padding: 15px;
            background: #ff4b2b;
            color: #fff;
            border: none;
            border-radius: 5px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }
        .checkout-btn:hover {
            background: #ff3d1f;
        }
        .checkout-form {
            margin: 15px 0 10px 0;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .checkout-form textarea,
        .checkout-form input[type="tel"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.95rem;
            resize: vertical;
        }
        .continue-shopping {
            display: block;
            text-align: center;
            margin-top: 15px;
            color: #ff4b2b;
            text-decoration: none;
            font-weight: 600;
        }
        .continue-shopping:hover {
            text-decoration: underline;
        }
        @media (max-width: 768px) {
            .cart-page-container {
                grid-template-columns: 1fr;
            }
            .cart-summary {
                position: static;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="container nav-container">
            <div class="logo">SWG.<span>SHOP</span></div>
            <nav>
                <ul>
                    <li><a href="index.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
                    <li><a href="collection.html">‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Ñ‡∏ä‡∏±‡∏ô</a></li>
                    <li><a href="best-seller.html">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</a></li>
                    <li><a href="contact.html">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
                    <li><a href="cart-page.html" class="active">üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="cart-page-section">
        <div class="container">
            <h1 style="margin-bottom: 40px; font-size: 2rem;">üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
            
            <div class="cart-page-container">
                <div class="cart-items-list">
                    <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                    <div id="cart-items-display"></div>
                </div>

                <div class="cart-summary">
                    <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
                    <div class="summary-row">
                        <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
                        <span id="summary-qty">0</span>
                    </div>
                    <div class="summary-row">
                        <span>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°</span>
                        <span id="summary-total">‡∏ø0</span>
                    </div>
                    <div class="checkout-form">
                        <label for="checkout-address">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</label>
                        <textarea id="checkout-address" placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô, ‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•, ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡πÄ‡∏Ç‡∏ï, ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î, ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå)" rows="3"></textarea>
                        <label for="checkout-phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
                        <input type="tel" id="checkout-phone" placeholder="‡πÄ‡∏ä‡πà‡∏ô 0812345678">
                        <label style="margin-top:8px;">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
                        <div style="display:flex; gap:12px; align-items:center; margin-top:6px;">
                            <label style="font-size:0.95rem;"><input type="radio" name="payment-method" value="qr" checked> ‡∏™‡πÅ‡∏Å‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô (QR)</label>
                            <label style="font-size:0.95rem;"><input type="radio" name="payment-method" value="cod"> ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (COD)</label>
                        </div>
                    </div>
                    <button class="checkout-btn" onclick="handleCheckout()">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
                    <a href="index.html" class="continue-shopping">‚Üê ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á</a>
                </div>
            </div>
        </div>
    </section>

   

    <footer>
        <p>&copy; 2026 SWG. SHOP. All rights reserved.</p>
    </footer>

    <script>
        function displayCartItems() {
            const items = JSON.parse(localStorage.getItem('cart')) || [];
            const container = document.getElementById('cart-items-display');
            const summaryQtyEl = document.getElementById('summary-qty');
            const summaryTotalEl = document.getElementById('summary-total');

            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-cart-message">
                        <p>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡πà‡∏∞</p>
                        <p style="font-size: 1rem; color: #bbb;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢!</p>
                        <a href="index.html">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á</a>
                    </div>
                `;
                summaryQtyEl.textContent = '0';
                summaryTotalEl.textContent = '‡∏ø0';
                return;
            }

            const html = items.map(item => `
                <div class="cart-item-row">
                    <div class="item-details">
                        <h3>${item.name}</h3>
                        <div style="color: #666; font-size: 0.85rem; margin-bottom: 5px;">
                            <span>‡∏ò‡∏µ‡∏°: <strong>${item.theme || 'üì¶ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤'}</strong></span>
                        </div>
                        ${item.size && item.size !== 'N/A' ? `<div style="color: #666; font-size: 0.85rem; margin-bottom: 5px;">‡πÑ‡∏ã‡∏™‡πå: <strong>${item.size}</strong></div>` : ''}
                        <div class="item-price">‡∏ø${item.price.toLocaleString()} x ${item.quantity}</div>
                    </div>
                    <div class="item-controls">
                        <button class="qty-btn" onclick="updateQty(${item.id}, ${item.quantity - 1})">‚àí</button>
                        <span style="width: 30px; text-align: center;">${item.quantity}</span>
                        <button class="qty-btn" onclick="updateQty(${item.id}, ${item.quantity + 1})">+</button>
                        <button class="item-remove" onclick="removeItem(${item.id})">‡∏•‡∏ö</button>
                    </div>
                </div>
            `).join('');

            container.innerHTML = html;

            // Update summary
            const totalQty = items.reduce((sum, item) => sum + item.quantity, 0);
            const totalPrice = items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            summaryQtyEl.textContent = totalQty;
            summaryTotalEl.textContent = '‡∏ø' + totalPrice.toLocaleString();
        }

        function updateQty(itemId, newQty) {
            let items = JSON.parse(localStorage.getItem('cart')) || [];
            const item = items.find(i => i.id === itemId);
            
            if (item) {
                if (newQty <= 0) {
                    items = items.filter(i => i.id !== itemId);
                } else {
                    item.quantity = newQty;
                }
                localStorage.setItem('cart', JSON.stringify(items));
                displayCartItems();
            }
        }

        function removeItem(itemId) {
            // ‡∏•‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ id ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡∏≠‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏ß‡πâ
            let items = JSON.parse(localStorage.getItem('cart')) || [];
            const indexToRemove = items.findIndex(i => i.id === itemId);
            
            if (indexToRemove !== -1) {
                // ‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≠‡∏Å ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏ß‡πâ
                items.splice(indexToRemove, 1);
                localStorage.setItem('cart', JSON.stringify(items));
                displayCartItems();
                console.log('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ ID:', itemId, '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:', items.length);
            }
        }

        function handleCheckout() {
            const items = JSON.parse(localStorage.getItem('cart')) || [];
            if (items.length === 0) {
                alert('‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡πà‡∏∞');
                return;
            }

            const addressEl = document.getElementById('checkout-address');
            const phoneEl = document.getElementById('checkout-phone');
            const address = addressEl ? addressEl.value.trim() : '';
            const phone = phoneEl ? phoneEl.value.trim() : '';

            if (!phone) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠');
                if (phoneEl) phoneEl.focus();
                return;
            }

            const phoneDigits = phone.replace(/[^0-9+]/g, '');
            if (phoneDigits.length < 9) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                if (phoneEl) phoneEl.focus();
                return;
            }

            if (!address) {
                const proceed = confirm('‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á\n‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?');
                if (!proceed) return;
            }

            const total = items.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            // read selected payment method
            const pm = document.querySelector('input[name="payment-method"]:checked');
            const paymentMethod = pm ? pm.value : 'qr';

            const order = {
                id: 'ORD' + Date.now(),
                items,
                total,
                phone: phoneDigits,
                address,
                paymentMethod,
                paymentStatus: paymentMethod === 'qr' ? 'awaiting_payment' : 'cod_pending',
                status: 'new',
                createdAt: new Date().toISOString()
            };

            try {
                // save lastOrder (for receipt) and push into orders list
                localStorage.setItem('lastOrder', JSON.stringify(order));
                const orders = JSON.parse(localStorage.getItem('orders')) || [];
                orders.push(order);
                localStorage.setItem('orders', JSON.stringify(orders));
            } catch (e) {
                console.warn('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏ô localStorage:', e);
            }

            alert('‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡πà‡∏∞!\n‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°: ‡∏ø' + total.toLocaleString() + '\n\n‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ' + phoneDigits + (address ? '\n‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:\n' + address : '\n\n(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á)'));

            localStorage.setItem('cart', JSON.stringify([]));
            displayCartItems();

            // ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏´‡∏•‡∏±‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
            window.location.href = 'receipt.html';
        }

        // Display cart when page loads
        document.addEventListener('DOMContentLoaded', () => {
            displayCartItems();
        });
    </script>

    <script src="cart.js"></script>
    <script src="chatbot.js"></script>

</body>
</html>
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SWG Shop Chatbot</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;700&display=swap" rel="stylesheet">

<style>
    /* ================= CSS: ‡∏™‡πà‡∏ß‡∏ô‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á ================= */
    body { font-family: 'Prompt', sans-serif; background-color: #fdf2f7; margin: 0; padding: 0; }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏°‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏î‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ä‡∏ó (‡∏•‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á) */
    .chatbot-toggler {
        position: fixed; bottom: 30px; right: 30px;
        width: 60px; height: 60px;
        background: #ff5e9a; border-radius: 50%; border: none; cursor: pointer;
        display: flex; align-items: center; justify-content: center;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        z-index: 9999; transition: transform 0.2s;
    }
    .chatbot-toggler:hover { transform: scale(1.1); }
    .chatbot-toggler svg { stroke: white; width: 30px; height: 30px; }

    /* ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏ä‡∏ó (‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å) */
    .chatbot-window {
        position: fixed; bottom: 100px; right: 30px;
        width: 360px; height: 550px; max-height: 80vh;
        background: #fff; border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        overflow: hidden; z-index: 9999;
        display: flex; flex-direction: column;
        transform: scale(0); opacity: 0; pointer-events: none;
        transform-origin: bottom right;
        transition: all 0.3s ease;
    }
    /* ‡∏Ñ‡∏•‡∏≤‡∏™‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡πÇ‡∏î‡∏¢ JS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏ä‡∏ó */
    .show-chat { transform: scale(1); opacity: 1; pointer-events: auto; }

    /* ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß (Header) */
    .chat-header {
        background: linear-gradient(135deg, #ff5e9a, #ff9bb6);
        padding: 15px 20px; color: white;
        display: flex; justify-content: space-between; align-items: center;
    }
    .chat-header h3 { margin: 0; font-size: 18px; font-weight: 600; }
    .close-btn { background: none; border: none; color: white; font-size: 24px; cursor: pointer; }

    /* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ä‡∏ó (Body) */
    .chat-box {
        flex: 1; padding: 15px; background: #fffcfd;
        overflow-y: auto; display: flex; flex-direction: column; gap: 12px;
    }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Chat Bubble */
    .message {
        max-width: 80%; padding: 10px 14px; border-radius: 12px;
        font-size: 14px; line-height: 1.5; word-wrap: break-word;
    }
    .bot-msg {
        align-self: flex-start; background: #f1f1f1; color: #333;
        border-bottom-left-radius: 2px;
    }
    .user-msg {
        align-self: flex-end; background: #ff5e9a; color: white;
        border-bottom-right-radius: 2px;
    }

    /* --- ‚ú® ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Product Card) ‚ú® --- */
    .product-list {
        display: flex; flex-direction: column; gap: 10px; width: 100%; margin-top: 5px;
    }
    .product-card {
        background: white;
        border: 1px solid #ff5e9a; /* ‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π */
        border-radius: 15px;       /* ‡∏°‡∏∏‡∏°‡∏°‡∏ô */
        padding: 12px 15px;
        display: flex; justify-content: space-between; align-items: center;
        cursor: pointer; transition: 0.2s;
        box-shadow: 0 2px 5px rgba(0,0,0,0.03);
    }
    .product-card:hover {
        background: #fff0f6; /* ‡∏ä‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π‡∏≠‡πà‡∏≠‡∏ô */
        transform: translateX(3px);
    }
    /* ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏∏‡∏î (‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ Emoji ‡∏à‡∏≤‡∏Å‡∏ä‡∏°‡∏û‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡πâ‡∏≤) */
    .icon-dress { 
        font-size: 20px; margin-right: 8px; 
        filter: hue-rotate(220deg) brightness(1.1); 
    }
    .prod-name { color: #ff5e9a; font-weight: 500; font-size: 14px; }
    .prod-price { color: #ff5e9a; font-weight: 700; font-size: 15px; }

    /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ò‡∏µ‡∏° */
    .theme-group { display: grid; gap: 8px; margin-top: 5px; }
    .theme-btn {
        padding: 10px; border-radius: 10px; border: 1px solid #ddd;
        background: white; text-align: center; cursor: pointer; font-size: 14px;
    }
    .theme-btn:hover { background: #eee; }

    /* ‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
    .chat-input {
        padding: 15px; background: white; border-top: 1px solid #eee;
        display: flex; gap: 10px;
    }
    .chat-input input {
        flex: 1; padding: 10px 15px; border: 1px solid #e0e0e0;
        border-radius: 25px; outline: none; font-family: 'Prompt';
    }
    .chat-input button {
        background: #ff5e9a; color: white; border: none;
        width: 40px; height: 40px; border-radius: 50%; cursor: pointer;
    }
</style>
</head>
<body>
 
    <button class="chatbot-toggler" onclick="toggleChat()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
    </button>

    <div class="chatbot-window" id="chat-window">
        <div class="chat-header">
            <h3>‡∏ô‡πâ‡∏≠‡∏á SWG (Admin) üçä</h3>
            <button class="close-btn" onclick="toggleChat()">√ó</button>
        </div>
        <div class="chat-box" id="chat-box"></div>
        
        <div class="chat-input">
            <label for="img-upload" style="cursor:pointer; font-size:24px; margin-right:8px;" title="‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô">üì∑</label>
            <input type="file" id="img-upload" accept="image/*" style="display:none" onchange="sendImage()">
            <input type="text" id="user-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button onclick="sendMessage()">‚û§</button>
        </div>
    </div>

    <script>
        // --- 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ---
        const catalog = {
            "bestseller": [
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ", price: 350, star: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê" },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏ã‡πá‡∏ï‡πÑ‡∏´‡∏°‡∏û‡∏£‡∏°‡∏•‡∏∞‡∏°‡∏∏‡∏ô", price: 420, star: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê" },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÇ‡∏ö‡∏ß‡πå‡∏ä‡∏°‡∏û‡∏π", price: 490, star: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê" },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∏‡∏ì‡∏´‡∏ô‡∏π‡πÇ‡∏ö‡∏ß‡πå‡∏´‡∏ß‡∏≤‡∏ô", price: 750, star: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê" },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ú‡∏π‡∏Å‡∏Ñ‡∏≠", price: 399, star: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê" },
                { name: "‡πÄ‡∏î‡∏£‡∏™‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏™‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏ß‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤", price: 650, star: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê" }
            ],
            "recommend": [
                 { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏•‡∏≤‡∏¢‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏•‡πá‡∏Å", price: 350 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏™‡∏µ‡∏Ñ‡∏£‡∏µ‡∏°‡∏•‡∏≤‡∏¢‡∏à‡∏∏‡∏î‡∏î‡∏≥", price: 450 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏•‡∏≤‡∏¢‡∏™‡∏Å‡πä‡∏≠‡∏ï", price: 490 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÅ‡∏Ç‡∏ô‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏¥‡∏°‡∏≠‡∏•", price: 550 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏•‡∏≤‡∏¢‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏õ‡∏±‡∏Å", price: 590 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏•‡∏≤‡∏¢‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÄ‡∏•‡πá‡∏Å", price: 350 }
            ],
            "white": [
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÇ‡∏ö‡∏ß‡πå‡∏´‡∏ô‡πâ‡∏≤", price: 359 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÅ‡∏Ç‡∏ô‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤", price: 459 },
                { name: "‡πÄ‡∏î‡∏£‡∏™‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏•‡∏π‡∏Å‡πÑ‡∏°‡πâ", price: 599 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ", price: 350 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÇ‡∏õ‡πÇ‡∏•", price: 490 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏ã‡πá‡∏ï‡πÑ‡∏´‡∏°‡∏û‡∏£‡∏°", price: 420 }
            ],
            "pink": [
               { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÇ‡∏ö‡∏ß‡πå‡πÑ‡∏´‡∏•‡πà‡∏´‡∏ß‡∏≤‡∏ô", price: 350 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÇ‡∏ö‡∏ß‡πå‡∏ä‡∏°‡∏û‡∏π", price: 490 },
                { name: "‡πÄ‡∏î‡∏£‡∏™‡∏•‡∏≤‡∏¢‡∏î‡∏≠‡∏Å‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö", price: 590 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏•‡∏≤‡∏¢‡∏à‡∏∏‡∏î‡∏ä‡∏°‡∏û‡∏π", price: 380 },
                { name: "‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∏‡∏ì‡∏´‡∏ô‡∏π‡πÇ‡∏ö‡∏ß‡πå‡∏´‡∏ß‡∏≤‡∏ô", price: 750 },
                { name: "‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏•‡∏µ‡∏ö‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö‡∏≠‡πà‡∏≠‡∏ô", price: 560 }
            ],
            "red": [
               { name: "‡∏ä‡∏∏‡∏î‡πÅ‡∏î‡∏á‡πÅ‡∏û‡∏á‡πÅ‡∏£‡∏á‡∏§‡∏ó‡∏ò‡∏¥‡πå", price: 599 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏™‡∏î", price: 599 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÅ‡∏î‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏´‡∏£‡∏π", price: 499 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÅ‡∏î‡∏á‡∏ú‡∏π‡∏Å‡∏Ñ‡∏≠", price: 399 },
                { name: "‡πÄ‡∏î‡∏£‡∏™‡πÅ‡∏î‡∏á‡∏™‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß", price: 650 },
                { name: "‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏£‡∏™‡πÇ‡∏ö‡∏ß‡πå‡πÅ‡∏î‡∏á", price: 399 }
            ]
        };

        // --- 2. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö ---
        let chatStep = 0;
        let myOrder = { item: "", price: 0, size: "", qty: 1, total: 0, address: "", payment: "" };
        let allProducts = [];
        Object.values(catalog).forEach(list => allProducts.push(...list));

        // --- 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ---
        function toggleChat() {
            const win = document.getElementById('chat-window');
            win.classList.toggle('show-chat');
            if(win.classList.contains('show-chat')) {
                const box = document.getElementById('chat-box');
                if(box.innerHTML.trim() === "") showMainMenu();
            }
        }

        function showMainMenu() {
            chatStep = 0;
            const chatBox = document.getElementById('chat-box');
            chatBox.innerHTML = ''; 
            
            addBotMsg("‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞! ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà SWG Shop üíñ<br>‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ö‡∏ä‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏ß‡∏î‡πÑ‡∏´‡∏ô‡∏î‡∏µ‡∏Ñ‡∏∞? üëá");

            const themesHtml = `
                <div class="theme-group">
                    <div class="theme-btn" onclick="selectTheme('bestseller')" style="background: linear-gradient(135deg, #fff 0%, #fffbe6 100%); color:#d48806; border: 1px solid #ffe58f;">üèÜ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ (Best Seller) ‚≠ê</div>
                    <div class="theme-btn" onclick="selectTheme('recommend')" style="background:#f0f5ff; color:#1d39c4; border-color:#adc6ff;">üåü ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (New Arrival)</div>
                    <div class="theme-btn" onclick="selectTheme('white')">ü§ç ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß (Minimal)</div>
                    <div class="theme-btn" onclick="selectTheme('pink')" style="color:#d63384; background:#fff0f6;">ü©∑ ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π (Sweet)</div>
                    <div class="theme-btn" onclick="selectTheme('red')" style="color:#c92a2a; background:#fff5f5;">‚ù§Ô∏è ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡πÅ‡∏î‡∏á (Hot)</div>
                </div>
            `;
            addBotMsg(themesHtml);
        }

        function selectTheme(themeKey) {
            chatStep = 1;
            let themeName = "";
            if(themeKey === 'bestseller') themeName = "üèÜ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ";
            else if(themeKey === 'recommend') themeName = "üåü ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥";
            else if(themeKey === 'white') themeName = "ü§ç ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß";
            else if(themeKey === 'pink') themeName = "ü©∑ ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π";
            else themeName = "‚ù§Ô∏è ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡πÅ‡∏î‡∏á";

            addBotMsg(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡∏π <b>${themeName}</b> ‡∏ô‡∏∞‡∏Ñ‡∏∞ üëá`);

            let listHtml = '<div class="product-list">';
            catalog[themeKey].forEach(p => {
                let starHtml = p.star ? `<span class="star-rating">${p.star}</span>` : '';
                listHtml += `
                <div class="product-card" onclick="selectProduct('${p.name}', ${p.price})">
                    <div>
                        <div class="prod-name">${p.name}</div>
                        ${starHtml}
                    </div>
                    <span class="prod-price">‡∏ø${p.price}</span>
                </div>`;
            });
            listHtml += '</div>';
            
            addBotMsg(listHtml);
        }

        function selectProduct(name, price) {
            sendMessage(name);
        }

        function sendMessage(textOverride = null) {
            const input = document.getElementById('user-input');
            const text = textOverride || input.value.trim();
            if (!text) return;

            addUserMsg(text);
            input.value = "";
            setTimeout(() => { processBotLogic(text); }, 600);
        }

        // --- 4. Logic ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏ö‡∏≠‡∏ó (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÉ‡∏´‡∏°‡πà) ---
        function processBotLogic(text) {
            
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
            if (text.includes("‡πÄ‡∏°‡∏ô‡∏π") || text.includes("‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà") || text.includes("‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ")) {
                showMainMenu();
                return;
            }
            else if (text.includes("‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á") || text.includes("‡∏™‡πà‡∏á‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó")) {
                addBotMsg("üì¶ ‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á **‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢ 50 ‡∏ö‡∏≤‡∏ó** ‡∏ó‡∏±‡πà‡∏ß‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏Ñ‡πà‡∏∞!<br>(‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏£‡∏ö 1,000.- ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ EMS ‡πÄ‡∏•‡∏¢‡∏ô‡πâ‡∏≤ üíñ)");
                return;
            }
            else if (text.includes("‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì") || text.includes("‡∏Ç‡∏≠‡∏ö‡πÉ‡∏à")) {
                addBotMsg("‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏≤ ü•∞ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô SWG Shop ‡∏ô‡∏∞‡∏Ñ‡∏∞ üôè‚ú®<br>‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏°‡∏≤‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≤‡∏≤ üíñ<br>(‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ä‡∏¥‡∏ç‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞‡∏Ñ‡∏∞)");
                return;
            }

            // --- FLOW ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ---
            if (chatStep === 0 || chatStep === 1) {
                const found = allProducts.find(p => p.name === text);
                if (found) {
                    myOrder.item = found.name;
                    myOrder.price = found.price;
                    chatStep = 2;
                    
                    // ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÑ‡∏ã‡∏™‡πå
                    const sizeInfo = `
                        ‡∏£‡∏±‡∏ö <b>${found.name}</b> (‡∏ø${found.price}) ‡∏ô‡∏∞‡∏Ñ‡∏∞ ‚ú®<br><br>
                        üìè <b>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÑ‡∏ã‡∏™‡πå (‡∏ô‡∏¥‡πâ‡∏ß):</b><br>
                        ‚Ä¢ <b>S</b> : ‡∏≠‡∏Å 32" / ‡πÄ‡∏≠‡∏ß 26" / ‡∏™‡∏∞‡πÇ‡∏û‡∏Å 36"<br>
                        ‚Ä¢ <b>M</b> : ‡∏≠‡∏Å 34" / ‡πÄ‡∏≠‡∏ß 28" / ‡∏™‡∏∞‡πÇ‡∏û‡∏Å 38"<br>
                        ‚Ä¢ <b>L</b> : ‡∏≠‡∏Å 36" / ‡πÄ‡∏≠‡∏ß 30" / ‡∏™‡∏∞‡πÇ‡∏û‡∏Å 40"<br>
                        ‚Ä¢ <b>XL</b>: ‡∏≠‡∏Å 38" / ‡πÄ‡∏≠‡∏ß 32" / ‡∏™‡∏∞‡πÇ‡∏û‡∏Å 42"<br><br>
                        ‡∏£‡∏±‡∏ö‡πÑ‡∏ã‡∏™‡πå‡∏≠‡∏∞‡πÑ‡∏£‡∏î‡∏µ‡∏Ñ‡∏∞? (‡∏û‡∏¥‡∏°‡∏û‡πå S, M, L ‡∏´‡∏£‡∏∑‡∏≠ XL ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞)
                    `;
                    addBotMsg(sizeInfo);
                } else {
                    addBotMsg("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞ üòä");
                }
            }
            else if (chatStep === 2) {
                myOrder.size = text.toUpperCase();
                chatStep = 3;
                addBotMsg(`‡πÑ‡∏ã‡∏™‡πå ${myOrder.size} ‡∏ô‡∏∞‡∏Ñ‡∏∞ üëå ‡∏£‡∏±‡∏ö‡∏Å‡∏µ‡πà‡∏ä‡∏∏‡∏î‡∏î‡∏µ‡∏Ñ‡∏∞?`);
            } 
            else if (chatStep === 3) {
                let qtyNum = parseInt(text.replace(/\D/g, '')); 
                if(isNaN(qtyNum) || qtyNum < 1) qtyNum = 1;
                myOrder.qty = qtyNum;
                myOrder.total = myOrder.price * qtyNum;
                chatStep = 4;
                addBotMsg(`‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° <b>‡∏ø${myOrder.total.toLocaleString()}</b> ‡∏Ñ‡πà‡∏∞<br>‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Ç‡∏≠ <b>‡∏ä‡∏∑‡πà‡∏≠-‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà-‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</b> ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞ üöö`);
            } 
            else if (chatStep === 4) {
                // ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà -> ‡∏ñ‡∏≤‡∏°‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                myOrder.address = text;
                chatStep = 5;
                addBotMsg(`‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡πà‡∏∞ üè°<br>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏ä‡∏≥‡∏£‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÑ‡∏´‡∏ô‡∏Ñ‡∏∞? üëá<br>
                    <div class="theme-group">
                        <div class="theme-btn" onclick="sendMessage('‡πÇ‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞')" style="border-color:#d63384; color:#d63384;">üèß ‡πÇ‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞</div>
                        <div class="theme-btn" onclick="sendMessage('‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á')" style="border-color:#198754; color:#198754;">üöö ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</div>
                    </div>`);
            }
            else if (chatStep === 5) {
                // ‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô -> ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î
                if (text.includes("‡πÇ‡∏≠‡∏ô") || text.includes("‡∏ö‡∏±‡∏ç‡∏ä‡∏µ")) {
                    myOrder.payment = "‡πÇ‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞";
                    chatStep = 6; // ‡πÑ‡∏õ‡∏£‡∏≠‡∏™‡∏•‡∏¥‡∏õ

                    // ‡πÉ‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î (‡πÇ‡∏≠‡∏ô)
                    const receiptHTML = `
                        <div class="receipt-card">
                            <div style="background:#f8f9fa; padding:10px; border-radius:8px; border:1px dashed #ccc;">
                                <div>üìÑ <b>‡πÉ‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡πÇ‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞)</b></div>
                                <hr style="margin:5px 0; border:0; border-top:1px dashed #ddd;">
                                <div>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${myOrder.item}</div>
                                <div>‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: <b style="color:#d63384;">‡∏ø${myOrder.total.toLocaleString()}</b></div>
                                <div style="font-size:12px; color:#666;">‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà: ${myOrder.address}</div>
                            </div>
                            <br>
                            üè¶ <b>‡∏ò.‡πÑ‡∏ó‡∏¢‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå (KBANK)</b><br>
                            ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: <b>063-0-89767-1</b><br>
                            ‡∏ä‡∏∑‡πà‡∏≠: ‡∏ö‡∏à‡∏Å. SWG Shop<br>
                            ---------------------------<br>
                            üí∏ ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á üì∑ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞
                        </div>
                    `;
                    addBotMsg(receiptHTML);
                    saveOrderToStorage(myOrder);
                } 
                else if (text.includes("‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á") || text.includes("COD")) {
                    myOrder.payment = "‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á";
                    chatStep = 0; // ‡∏à‡∏ö‡∏á‡∏≤‡∏ô‡πÄ‡∏•‡∏¢

                    // ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏
                    const randomNum = Math.floor(10000000 + Math.random() * 90000000);
                    const trackingNo = `COD${randomNum}TH`;

                    // ‡πÉ‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î (‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á)
                    const receiptHTML = `
                        <div class="receipt-card">
                            <div style="background:#e8f5e9; padding:10px; border-radius:8px; border:1px dashed #198754;">
                                <div>üìÑ <b>‡πÉ‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á)</b></div>
                                <hr style="margin:5px 0; border:0; border-top:1px dashed #aadeb6;">
                                <div>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${myOrder.item}</div>
                                <div>‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢: <b style="color:#198754;">‡∏ø${myOrder.total.toLocaleString()}</b></div>
                                <div style="font-size:12px; color:#666;">‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà: ${myOrder.address}</div>
                            </div>
                            <br>
                            ‚úÖ <b>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡πà‡∏∞!</b><br>
                            üì¶ ‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏: <b>${trackingNo}</b><br>
                            üöö ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏™‡∏≤‡∏¢‡∏û‡∏µ‡πà‡∏Ç‡∏ô‡∏™‡πà‡∏á 2-3 ‡∏ß‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞<br>
                            (‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÑ‡∏ß‡πâ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏≤ ü•∞)<br>
                            ---------------------------<br>
                            <i>‡∏û‡∏¥‡∏°‡∏û‡πå "‡πÄ‡∏°‡∏ô‡∏π" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡πâ‡∏≤</i>
                        </div>
                    `;
                    addBotMsg(receiptHTML);
                    saveOrderToStorage(myOrder);
                } else {
                    addBotMsg("‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡πâ‡∏≤ (‡∏û‡∏¥‡∏°‡∏û‡πå '‡πÇ‡∏≠‡∏ô' ‡∏´‡∏£‡∏∑‡∏≠ '‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á' ‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞) üòä");
                }
            }
            else if (chatStep === 6) {
                // ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏™‡∏•‡∏¥‡∏õ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏≠‡∏ô)
                const randomNum = Math.floor(10000000 + Math.random() * 90000000);
                const trackingNo = `SWG${randomNum}TH`;

                const deliveryMsg = `
                    ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡πÇ‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞! üí∏üíñ<br>
                    ‡∏ó‡∏≤‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡∏≠‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞‡∏Ñ‡∏∞<br>
                    --------------------------------<br>
                    üì¶ <b>‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏:</b> <span style="color:#d63384; font-weight:bold;">${trackingNo}</span><br>
                    üöö <b>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</b> ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2-3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>
                    --------------------------------<br>
                    ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô SWG Shop ‡∏ô‡∏∞‡∏Ñ‡∏∞ üôè‚ú®<br>
                    <i>(‡∏û‡∏¥‡∏°‡∏û‡πå "‡πÄ‡∏°‡∏ô‡∏π" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡πâ‡∏≤)</i>
                `;
                addBotMsg(deliveryMsg);
                chatStep = 0; // ‡∏à‡∏ö‡∏á‡∏≤‡∏ô
            }
        }

        // --- 5. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ ---
        function sendImage() {
            const fileInput = document.getElementById('img-upload');
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imgHtml = `<img src="${e.target.result}" style="width:100%; max-width: 200px; border-radius: 10px; border: 2px solid #fff;">`;
                    const chatBox = document.getElementById('chat-box');
                    chatBox.innerHTML += `<div class="message user-msg">${imgHtml}</div>`;
                    scrollToBottom();

                    setTimeout(() => { 
                        // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏£‡∏≠‡∏™‡∏•‡∏¥‡∏õ (6) ‡πÉ‡∏´‡πâ‡∏à‡∏ö‡∏á‡∏≤‡∏ô
                        if (chatStep === 6) {
                            processBotLogic("‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞");
                        } else {
                            // ‡∏ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏ö‡πÄ‡∏•‡πà‡∏ô‡πÜ ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏≠‡∏∑‡πà‡∏ô
                            addBotMsg("‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≤ üì∏");
                        }
                    }, 1000);
                };
                reader.readAsDataURL(file);
            }
            fileInput.value = "";
        }

        function saveOrderToStorage(orderData) {
            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ Google Sheets
            let newOrder = {
                date: new Date().toLocaleString('th-TH'),
                item: orderData.item,
                size: orderData.size,
                qty: orderData.qty,
                total: orderData.total,
                payment: orderData.payment,
                address: orderData.address
            };

            // ‚ùå ‡πÄ‡∏≠‡∏≤ URL ‡∏¢‡∏≤‡∏ß‡πÜ ‡∏ó‡∏µ‡πà‡∏Å‡πä‡∏≠‡∏õ‡∏°‡∏≤‡∏à‡∏≤‡∏Å Google Script ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö ‚ùå
            const googleSheetURL = "https://script.google.com/macros/s/AKfycbznEz_eMs_m87IXG0jyQZBQG3zs9-LFQ7Ec4RjEXrBIrNT7VCGsStlbb3OnZ7Hdy4TH5g/exec"; 

            // ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≤‡∏°‡πÄ‡∏ß‡πá‡∏ö
            fetch(googleSheetURL, {
                method: 'POST',
                mode: 'no-cors', // ‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πá‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                headers: {
                    'Content-Type': 'text/plain',
                },
                body: JSON.stringify(newOrder)
            })
            .then(() => {
                console.log("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
            })
            .catch((error) => {
                console.error("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", error);
            });
        }

        function addBotMsg(html) {
            const chatBox = document.getElementById('chat-box');
            chatBox.innerHTML += `<div class="message bot-msg">${html}</div>`;
            scrollToBottom();
        }
        function addUserMsg(text) {
            const chatBox = document.getElementById('chat-box');
            chatBox.innerHTML += `<div class="message user-msg">${text}</div>`;
            scrollToBottom();
        }
        function scrollToBottom() {
            const chatBox = document.getElementById('chat-box');
            chatBox.scrollTop = chatBox.scrollHeight;
        }
    </script>
</body>
</html>